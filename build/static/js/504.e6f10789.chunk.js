"use strict";(self.webpackChunkthetower=self.webpackChunkthetower||[]).push([[504],{53016:(e,i,s)=>{s.d(i,{Z:()=>l});s(72791);var t=s(2409),r=s(49389),a=s(80184);const l=e=>{let{label:i,name:s,required:l,required_text:n,warning:d}=e;return(0,a.jsx)(t.Z.Item,{label:d?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:i}),(0,a.jsx)("br",{}),(0,a.jsx)("p",{children:d})]}):(0,a.jsx)("div",{children:i}),name:s,rules:[{required:l,message:n}],children:(0,a.jsx)(r.default,{})})}},63159:(e,i,s)=>{s.d(i,{Z:()=>l});s(72791);var t=s(2409),r=s(13344),a=s(80184);const l=e=>{let{label:i,name:s,required:l,required_text:n}=e;return(0,a.jsx)(t.Z.Item,{label:i,name:s,rules:[{required:l,message:n}],children:(0,a.jsx)(r.Z,{style:{width:"100%"}})})}},83386:(e,i,s)=>{s.d(i,{Z:()=>l});s(72791);var t=s(2409),r=s(66920),a=s(80184);const l=e=>{let{label:i,name:s,required:l,required_text:n}=e;return(0,a.jsx)(t.Z.Item,{label:i,name:s,rules:[{required:l,message:n}],children:(0,a.jsx)(r.Z,{rows:4})})}},14504:(e,i,s)=>{s.r(i),s.d(i,{default:()=>w});var t=s(72791),r=s(521),a=s(2409),l=s(50419),n=s(66106),d=s(30914),o=s(87309),u=s(93086),c=s(91933),m=s(27169),_=s(94533),p=s(57689),h=s(16030),g=s(68117),x=s(77221),v=s(53016),Z=s(83386),j=s(63159),b=s(68747),f=s(80184);const{Title:q}=r.default,y={title_uz:"",title_ru:"",title_en:"",description_ru:"",description_uz:"",description_en:"",room_size:"",capacity:null,num_balconies:null,num_bathrooms:null,room_characteristics:[{title_ru:"",title_uz:"",title_en:""}],image_ids:[],gallery_image_ids:[]},w=()=>{const[e]=a.Z.useForm(),i=(0,p.s0)(),{editId:s}=(0,h.v9)((e=>e.editData)),r=(0,h.I0)(),[w,F]=(0,t.useState)([]),[z,S]=(0,t.useState)([]),[I,k]=(0,t.useState)(""),{mutate:E,data:D,isLoading:C,isSuccess:L}=(0,c.useMutation)((e=>{let{url:i,formData:s}=e;return m.Z.postData(i,s)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let i in e.response.data)l.ZP.error("".concat(i,": ").concat(e.response.data[i][0]))}}),{mutate:P,data:V,isLoading:T,isSuccess:U}=(0,c.useMutation)((e=>{let{url:i,data:s}=e;return m.Z.postData(i,s)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let i in e.response.data)l.ZP.error("".concat(i,": ").concat(e.response.data[i][0]))}}),{isLoading:R,data:M,refetch:O,isSuccess:A}=(0,c.useQuery)(["edit-rooms",s],(()=>m.Z.getDataByID("/rooms",s)),{enabled:!1}),{mutate:B,isLoading:J,data:N,isSuccess:Q}=(0,c.useMutation)((e=>{let{url:i,data:s,id:t}=e;return m.Z.editData(i,s,t)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let i in e.response.data)l.ZP.error("".concat(i,": ").concat(e.response.data[i][0]))}}),{mutate:X}=(0,c.useMutation)((e=>{let{url:i,ids:s}=e;return m.Z.deleteImages(i,s)}),{onSuccess:()=>l.ZP.success("Success"),onError:e=>l.ZP.error(e.message)});(0,t.useEffect)((()=>{Q&&r({type:x.Pb,payload:""}),(U||Q)&&i("/rooms")}),[V,N]),(0,t.useEffect)((()=>{""!==s&&O()}),[s]),(0,t.useEffect)((()=>{""===s&&e.setFieldsValue(y)}),[]),(0,t.useEffect)((()=>{const i=[],s=[];if(void 0!==M&&(M.images.map((e=>{const s={uid:e.id,name:e.id,status:"done",url:e.image};i.push(s)})),M.room_gallery.map((e=>{const i={uid:e.id,name:e.id,status:"done",url:e.image};s.push(i)}))),A){const t={title_uz:null===M||void 0===M?void 0:M.title_uz,title_ru:null===M||void 0===M?void 0:M.title_ru,title_en:null===M||void 0===M?void 0:M.title_en,description_ru:null===M||void 0===M?void 0:M.description_ru,description_uz:null===M||void 0===M?void 0:M.description_uz,description_en:null===M||void 0===M?void 0:M.description_en,room_size:null===M||void 0===M?void 0:M.room_size,capacity:null===M||void 0===M?void 0:M.capacity,num_balconies:null===M||void 0===M?void 0:M.num_balconies,num_bathrooms:null===M||void 0===M?void 0:M.num_bathrooms,room_characteristics:null===M||void 0===M?void 0:M.room_characteristics,image_ids:i,gallery_image_ids:s};F(i),S(s),e.setFieldsValue(t)}}),[M]);(0,t.useEffect)((()=>{const i=JSON.parse(localStorage.getItem("myFormValues"));i&&(i.images=[],e.setFieldsValue(i));const s=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",s),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",s)}}),[]),(0,t.useEffect)((()=>{if(L&&"images"===I){var i,s,t;const r=[...w],a={uid:null===D||void 0===D||null===(i=D.images[0])||void 0===i?void 0:i.id,name:null===D||void 0===D||null===(s=D.images[0])||void 0===s?void 0:s.id,status:"done",url:null===D||void 0===D||null===(t=D.images[0])||void 0===t?void 0:t.url};r.push(a),e.setFieldsValue({image_ids:[a]}),F(r),k("")}if(L&&"galleryImages"===I){var r,a,l;const i=[...z],s={uid:null===D||void 0===D||null===(r=D.images[0])||void 0===r?void 0:r.id,name:null===D||void 0===D||null===(a=D.images[0])||void 0===a?void 0:a.id,status:"done",url:null===D||void 0===D||null===(l=D.images[0])||void 0===l?void 0:l.url};i.push(s),e.setFieldsValue({gallery_image_ids:[s]}),S(i),k("")}}),[D]);const H=async e=>{let i=e.url;i||(i=await new Promise((i=>{const s=new FileReader;s.readAsDataURL(e.originFileObj),s.onload=()=>i(s.result)})));const s=new Image;s.src=i;const t=window.open(i);null===t||void 0===t||t.document.write(s.outerHTML)};return(0,f.jsx)("div",{children:T||R||J||C?(0,f.jsx)(_.QP,{}):(0,f.jsxs)(a.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:y,onFinish:e=>{const i=[],t=[];w.map((e=>{i.push(e.uid)})),z.map((e=>{t.push(e.uid)}));const r={image_ids:i,gallery_image_ids:t,title_uz:e.title_uz,title_ru:e.title_ru,title_en:e.title_en,description_ru:e.description_ru,description_uz:e.description_uz,description_en:e.description_en,room_size:e.room_size,capacity:e.capacity,num_balconies:e.num_balconies,num_bathrooms:e.num_bathrooms,room_characteristics:e.room_characteristics};A?B({url:"/rooms",data:r,id:s}):P({url:"/rooms/",data:r})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,f.jsxs)(n.Z,{gutter:20,children:[(0,f.jsx)(d.Z,{span:24,children:(0,f.jsx)(v.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",label:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a Ru",name:"title_ru"})}),(0,f.jsx)(d.Z,{span:24,children:(0,f.jsx)(v.Z,{required:!0,required_text:"Sarlavha kiritish kerak",label:"Sarlavha Uz",name:"title_uz"})}),(0,f.jsx)(d.Z,{span:24,children:(0,f.jsx)(v.Z,{required:!0,required_text:"A title is required",label:"Title En",name:"title_en"})})]}),(0,f.jsxs)(n.Z,{gutter:20,children:[(0,f.jsx)(d.Z,{span:12,children:(0,f.jsx)(j.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0440\u0430\u0437\u043c\u0435\u0440 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",name:"room_size"})}),(0,f.jsx)(d.Z,{span:12,children:(0,f.jsx)(j.Z,{required:!0,required_text:"\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u0435\u0441\u043a\u0438\u0439 \u043f\u043e\u0442\u0435\u043d\u0446\u0438\u0430\u043b \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c",label:"\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u0435\u0441\u043a\u0438\u0439 \u043f\u043e\u0442\u0435\u043d\u0446\u0438\u0430\u043b",name:"capacity"})}),(0,f.jsx)(d.Z,{span:12,children:(0,f.jsx)(j.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u0432.",label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u0432",name:"num_balconies"})}),(0,f.jsx)(d.Z,{span:12,children:(0,f.jsx)(j.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043d\u0430\u0442.",label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043d\u0430\u0442",name:"num_bathrooms"})})]}),(0,f.jsxs)(n.Z,{gutter:20,children:[(0,f.jsx)(d.Z,{span:24,children:(0,f.jsx)(Z.Z,{required:!0,required_text:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 Ru",name:"description_ru"})}),(0,f.jsx)(d.Z,{span:24,children:(0,f.jsx)(Z.Z,{required:!0,required_text:"Tavsif kiritish kerak",label:"Tavsif Uz",name:"description_uz"})}),(0,f.jsx)(d.Z,{span:24,children:(0,f.jsx)(Z.Z,{required:!0,required_text:"A description is required",label:"Description En",name:"description_en"})})]}),(0,f.jsx)(q,{level:3,children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u043d\u043e\u043c\u0435\u0440\u0430"}),(0,f.jsx)(a.Z.List,{name:"room_characteristics",children:(e,i)=>{let{add:s,remove:t}=i;return(0,f.jsxs)(f.Fragment,{children:[e.map(((e,i)=>(0,f.jsxs)("div",{style:{marginBottom:20},children:[(0,f.jsxs)(n.Z,{gutter:20,children:[(0,f.jsx)(d.Z,{span:8,children:(0,f.jsx)(v.Z,{required:!0,required_text:"\u0414\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u0444\u0443\u043d\u043a\u0446\u0438\u0438",label:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 Ru ".concat(i+1),name:[e.name,"title_ru"]})}),(0,f.jsx)(d.Z,{span:8,children:(0,f.jsx)(v.Z,{required:!0,required_text:"Xususiyatlari kiritish kerak",label:"Xususiyatlari Uz ".concat(i+1),name:[e.name,"title_uz"]})}),(0,f.jsx)(d.Z,{span:8,children:(0,f.jsx)(v.Z,{required:!0,required_text:"Features must be included",label:"Characteristics En ".concat(i+1),name:[e.name,"title_en"]})})]}),(0,f.jsx)(b.Z,{onClick:()=>t(e.name)})]},e.fieldKey))),(0,f.jsx)(a.Z.Item,{children:(0,f.jsx)(o.Z,{type:"primary",onClick:()=>s(),block:!0,style:{backgroundColor:"#28a745"},children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b \u0434\u043b\u044f \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0430"})})]})}}),(0,f.jsxs)(n.Z,{gutter:20,children:[(0,f.jsx)(d.Z,{span:12,children:(0,f.jsx)(a.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",name:"image_ids",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}],children:(0,f.jsx)(g.Z,{children:(0,f.jsx)(u.Z,{maxCount:3,fileList:w,listType:"picture-card",onChange:e=>{let{fileList:i}=e;if(i.length<w.length)return;const s=new FormData;0!==i.length&&(s.append("uploaded_images",i[i.length-1].originFileObj),E({url:"/images/",formData:s}),k("images"))},onPreview:H,onRemove:i=>{const s=[];w.map((e=>{(null===e||void 0===e?void 0:e.uid)!==(null===i||void 0===i?void 0:i.uid)&&s.push(e)})),!s.length>0&&e.setFieldsValue({image_ids:[]});const t={image_ids:[null===i||void 0===i?void 0:i.uid]};X({url:"/images/delete",ids:t}),F(s)},beforeUpload:()=>!1,children:w.length>2?"":"Upload"})})})}),(0,f.jsx)(d.Z,{span:12,children:(0,f.jsx)(a.Z.Item,{label:"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438",name:"gallery_image_ids",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}],children:(0,f.jsx)(g.Z,{children:(0,f.jsx)(u.Z,{maxCount:3,fileList:z,listType:"picture-card",onChange:e=>{let{fileList:i}=e;if(i.length<z.length)return;const s=new FormData;0!==i.length&&(s.append("uploaded_images",i[i.length-1].originFileObj),E({url:"/images/",formData:s}),k("galleryImages"))},onPreview:H,onRemove:i=>{const s=[];z.map((e=>{(null===e||void 0===e?void 0:e.uid)!==(null===i||void 0===i?void 0:i.uid)&&s.push(e)})),!s.length>0&&e.setFieldsValue({gallery_image_ids:[]});const t={image_ids:[null===i||void 0===i?void 0:i.uid]};X({url:"/images/delete",ids:t}),S(s)},beforeUpload:()=>!1,children:z.length>2?"":"Upload"})})})})]}),(0,f.jsx)(o.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:A?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442"})]})})}}}]);
//# sourceMappingURL=504.e6f10789.chunk.js.map