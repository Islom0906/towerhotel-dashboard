"use strict";(self.webpackChunkthetower=self.webpackChunkthetower||[]).push([[310],{53016:(e,t,a)=>{a.d(t,{Z:()=>l});a(72791);var r=a(2409),s=a(49389),i=a(80184);const l=e=>{let{label:t,name:a,required:l,required_text:n,warning:d}=e;return(0,i.jsx)(r.Z.Item,{label:d?(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:t}),(0,i.jsx)("br",{}),(0,i.jsx)("p",{children:d})]}):(0,i.jsx)("div",{children:t}),name:a,rules:[{required:l,message:n}],children:(0,i.jsx)(s.default,{})})}},19310:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var r=a(72791),s=a(2409),i=a(50419),l=a(66106),n=a(30914),d=a(93086),o=a(87309),u=a(91933),c=a(27169),m=a(94533),p=a(57689),h=a(16030),g=a(77221),x=a(68117),_=a(53016),f=a(80184);const j={header_image:[],title_ru:"",title_uz:"",title_en:""},w=()=>{const[e]=s.Z.useForm(),t=(0,p.s0)(),{editId:a}=(0,h.v9)((e=>e.editData)),w=(0,h.I0)(),[Z,b]=(0,r.useState)([]),{mutate:v,data:F,isLoading:S,isSuccess:y}=(0,u.useMutation)((e=>{let{url:t,data:a}=e;return c.Z.postData(t,a)}),{onSuccess:()=>{i.ZP.success("Success")},onError:e=>{for(let t in e.response.data)i.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{isLoading:E,data:I,refetch:q,isSuccess:L}=(0,u.useQuery)(["edit-news-banner",a],(()=>c.Z.getDataByID("/pages/newspage",a)),{enabled:!1}),{mutate:V,isLoading:D,data:P,isSuccess:k}=(0,u.useMutation)((e=>{let{url:t,data:a,id:r}=e;return c.Z.editData(t,a,r)}),{onSuccess:()=>{i.ZP.success("Success")},onError:e=>{for(let t in e.response.data)i.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}});(0,r.useEffect)((()=>{k&&w({type:g.Pb,payload:""}),(y||k)&&t("/news-banner")}),[F,P]),(0,r.useEffect)((()=>{""!==a&&q()}),[a]),(0,r.useEffect)((()=>{""===a&&e.setFieldsValue(j)}),[]),(0,r.useEffect)((()=>{if(L){const t=[{uid:I.id,name:I.id,status:"done",url:I.header_image}],a={header_image:t,title_ru:I.title_ru,title_uz:I.title_uz,title_en:I.title_en};b(t),e.setFieldsValue(a)}}),[I]);(0,r.useEffect)((()=>{const t=JSON.parse(localStorage.getItem("myFormValues"));t&&(t.images=[],e.setFieldsValue(t));const a=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",a),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",a)}}),[]);return(0,f.jsx)("div",{children:S||E||D?(0,f.jsx)(m.QP,{}):(0,f.jsxs)(s.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:j,onFinish:e=>{var t;const r=new FormData;var s;(r.append("title_ru",e.title_ru),r.append("title_uz",e.title_uz),r.append("title_en",e.title_en),null!==(t=Z[0])&&void 0!==t&&t.originFileObj)&&r.append("header_image",null===(s=Z[0])||void 0===s?void 0:s.originFileObj);I?V({url:"/pages/newspage",data:r,id:a}):v({url:"/pages/newspage/",data:r})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,f.jsxs)(l.Z,{gutter:20,children:[(0,f.jsx)(n.Z,{span:8,children:(0,f.jsx)(_.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",label:"Title Ru",name:"title_ru"})}),(0,f.jsx)(n.Z,{span:8,children:(0,f.jsx)(_.Z,{required:!0,required_text:"Sarlavha kiritish kerak",label:"Title Uz",name:"title_uz"})}),(0,f.jsx)(n.Z,{span:8,children:(0,f.jsx)(_.Z,{required:!0,required_text:"A title must be entered",label:"Title En",name:"title_en"})})]}),(0,f.jsx)(l.Z,{gutter:20,children:(0,f.jsx)(n.Z,{span:12,children:(0,f.jsx)(s.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430",name:"header_image",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430."}],children:(0,f.jsx)(x.Z,{rotationSlider:!0,children:(0,f.jsx)(d.Z,{maxCount:1,fileList:Z,listType:"picture-card",onChange:t=>{let{fileList:a}=t;b(a),e.setFieldsValue({header_image:a})},onPreview:async e=>{let t=e.url;t||(t=await new Promise((t=>{const a=new FileReader;a.readAsDataURL(e.originFileObj),a.onload=()=>t(a.result)})));const a=new Image;a.src=t;const r=window.open(t);null===r||void 0===r||r.document.write(a.outerHTML)},beforeUpload:()=>!1,children:Z.length>0?"":"Upload"})})})})}),(0,f.jsx)(o.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:L?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=310.6f51bcc0.chunk.js.map