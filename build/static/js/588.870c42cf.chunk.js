"use strict";(self.webpackChunkthetower=self.webpackChunkthetower||[]).push([[588],{53016:(e,t,a)=>{a.d(t,{Z:()=>r});a(72791);var i=a(2409),l=a(49389),s=a(80184);const r=e=>{let{label:t,name:a,required:r,required_text:n,warning:d}=e;return(0,s.jsx)(i.Z.Item,{label:d?(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:t}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{children:d})]}):(0,s.jsx)("div",{children:t}),name:a,rules:[{required:r,message:n}],children:(0,s.jsx)(l.default,{})})}},63159:(e,t,a)=>{a.d(t,{Z:()=>r});a(72791);var i=a(2409),l=a(13344),s=a(80184);const r=e=>{let{label:t,name:a,required:r,required_text:n}=e;return(0,s.jsx)(i.Z.Item,{label:t,name:a,rules:[{required:r,message:n}],children:(0,s.jsx)(l.Z,{style:{width:"100%"}})})}},48588:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var i=a(72791),l=a(521),s=a(2409),r=a(50419),n=a(66106),d=a(30914),o=a(93086),u=a(83734),c=a(87309),m=a(91933),v=a(27169),g=a(94533),x=a(57689),p=a(16030),h=a(68117),Z=a(68747),j=a(77221),_=a(53016),f=a(63159),b=a(80184);const{Title:y}=l.default,q={image:[],title_uz:"",title_ru:"",title_en:"",landmarks:[{distance:"",distance_type:"",title_uz:"",title_ru:"",title_en:""}]},k=()=>{const[e]=s.Z.useForm(),t=(0,x.s0)(),{editId:a}=(0,p.v9)((e=>e.editData)),l=(0,p.I0)(),[k,w]=(0,i.useState)([]),{mutate:S,data:F,isLoading:I,isSuccess:E}=(0,m.useMutation)((e=>{let{url:t,formData:a}=e;return v.Z.postData(t,a)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{for(let t in e.response.data)r.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{mutate:L,data:P,isLoading:C,isSuccess:D}=(0,m.useMutation)((e=>{let{url:t,data:a}=e;return v.Z.postData(t,a)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{for(let t in e.response.data)r.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{isLoading:z,data:V,refetch:M,isSuccess:T}=(0,m.useQuery)(["edit-landmark",a],(()=>v.Z.getDataByID("/landmarkcategories",a)),{enabled:!1}),{mutate:R,isLoading:U,data:J,isSuccess:O}=(0,m.useMutation)((e=>{let{url:t,data:a,id:i}=e;return v.Z.editData(t,a,i)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{for(let t in e.response.data)r.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{mutate:A}=(0,m.useMutation)((e=>{let{url:t,ids:a}=e;return v.Z.deleteImages(t,a)}),{onSuccess:()=>r.ZP.success("Success"),onError:e=>r.ZP.error(e.message)});(0,i.useEffect)((()=>{O&&l({type:j.Pb,payload:""}),(D||O)&&t("/landmark")}),[P,J]),(0,i.useEffect)((()=>{""!==a&&M()}),[a]),(0,i.useEffect)((()=>{""===a&&e.setFieldsValue(q)}),[]),(0,i.useEffect)((()=>{let t=null;if(void 0!==V&&(t=[{uid:null===V||void 0===V?void 0:V.image.id,name:null===V||void 0===V?void 0:V.image.id,status:"done",url:null===V||void 0===V?void 0:V.image.image}]),T){var a;const i={title_uz:null===V||void 0===V?void 0:V.title_uz,title_ru:null===V||void 0===V?void 0:V.title_ru,title_en:null===V||void 0===V?void 0:V.title_en,image:null===V||void 0===V||null===(a=V.image)||void 0===a?void 0:a.id,landmarks:null===V||void 0===V?void 0:V.landmarks};w(t),e.setFieldsValue(i)}}),[V]);(0,i.useEffect)((()=>{const t=JSON.parse(localStorage.getItem("myFormValues"));t&&(t.images=[],e.setFieldsValue(t));const a=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",a),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",a)}}),[]),(0,i.useEffect)((()=>{if(E){var t,a,i;const l=[{uid:null===F||void 0===F||null===(t=F.images[0])||void 0===t?void 0:t.id,name:null===F||void 0===F||null===(a=F.images[0])||void 0===a?void 0:a.id,status:"done",url:null===F||void 0===F||null===(i=F.images[0])||void 0===i?void 0:i.url}];e.setFieldsValue({image:l}),w(l)}}),[F]);const B=(0,i.useMemo)((()=>[{value:"km",label:"\u041a\u043c"},{value:"m",label:"\u041c"}]),[]);return(0,b.jsx)("div",{children:C||z||U||I?(0,b.jsx)(g.QP,{}):(0,b.jsxs)(s.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:q,onFinish:e=>{var t;const i={image:null===(t=k[0])||void 0===t?void 0:t.uid,title_uz:e.title_uz,title_ru:e.title_ru,title_en:e.title_en,landmarks:null===e||void 0===e?void 0:e.landmarks};console.log(i),T?R({url:"/landmarkcategories",data:i,id:a}):L({url:"/landmarkcategories/",data:i})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,b.jsxs)(n.Z,{gutter:20,children:[(0,b.jsx)(d.Z,{span:8,children:(0,b.jsx)(_.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",label:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a Ru",name:"title_ru"})}),(0,b.jsx)(d.Z,{span:8,children:(0,b.jsx)(_.Z,{required:!0,required_text:"Sarlavha kiritish kerak",label:"Sarlavha Uz",name:"title_uz"})}),(0,b.jsx)(d.Z,{span:8,children:(0,b.jsx)(_.Z,{required:!0,required_text:"A title is required",label:"Title En",name:"title_en"})})]}),(0,b.jsx)(n.Z,{gutter:20,children:(0,b.jsx)(d.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",name:"image",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}],children:(0,b.jsx)(h.Z,{children:(0,b.jsx)(o.Z,{maxCount:1,fileList:k,listType:"picture-card",onChange:e=>{let{fileList:t}=e;const a=new FormData;0!==t.length&&(a.append("uploaded_images",t[0].originFileObj),S({url:"/images/",formData:a}))},onPreview:async e=>{let t=e.url;t||(t=await new Promise((t=>{const a=new FileReader;a.readAsDataURL(e.originFileObj),a.onload=()=>t(a.result)})));const a=new Image;a.src=t;const i=window.open(t);null===i||void 0===i||i.document.write(a.outerHTML)},onRemove:t=>{const a={image_ids:[null===t||void 0===t?void 0:t.uid]};A({url:"/images/delete",ids:a}),w([]),e.setFieldsValue({image:[]})},beforeUpload:()=>!1,children:k.length>0?"":"Upload"})})})})}),(0,b.jsx)(y,{level:3,children:"\u041e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u044b \u043f\u043e\u0431\u043b\u0438\u0437\u043e\u0441\u0442\u0438"}),(0,b.jsx)(s.Z.List,{name:"landmarks",children:(e,t)=>{let{add:a,remove:i}=t;return(0,b.jsxs)(b.Fragment,{children:[e.map(((e,t)=>(0,b.jsxs)("div",{style:{marginBottom:20},children:[(0,b.jsxs)(n.Z,{gutter:20,children:[(0,b.jsx)(d.Z,{span:8,children:(0,b.jsx)(_.Z,{required:!0,required_text:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f.",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f Ru ".concat(t+1),name:[e.name,"title_ru"]})}),(0,b.jsx)(d.Z,{span:8,children:(0,b.jsx)(_.Z,{required:!0,required_text:"Joylashuv nomi kiritish talab qilinadi",label:"Joylashuv nomi Uz ".concat(t+1),name:[e.name,"title_uz"]})}),(0,b.jsx)(d.Z,{span:8,children:(0,b.jsx)(_.Z,{required:!0,required_text:"A location name is required",label:"Location name En ".concat(t+1),name:[e.name,"title_en"]})}),(0,b.jsx)(d.Z,{span:12,children:(0,b.jsx)(f.Z,{required:!0,required_text:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b",label:"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 ".concat(t+1),name:[e.name,"distance"]})}),(0,b.jsx)(d.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:"\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u044f",name:[e.name,"distance_type"],rules:[{required:!0,message:"\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u044b\u0431\u0440\u0430\u0442\u044c"}],wrapperCol:{span:24},children:(0,b.jsx)(u.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0435\u0434\u0438\u043d\u0438\u0446\u0443 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u044f",optionLabelProp:"label",options:B})})})]}),(0,b.jsx)(Z.Z,{onClick:()=>i(e.name)})]},e.fieldKey))),(0,b.jsx)(s.Z.Item,{children:(0,b.jsx)(c.Z,{type:"primary",onClick:()=>a(),block:!0,style:{backgroundColor:"#28a745"},children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b \u0434\u043b\u044f \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0430"})})]})}}),(0,b.jsx)(c.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:T?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442"})]})})}}}]);
//# sourceMappingURL=588.870c42cf.chunk.js.map